@using carrentalmvc.Models
@using carrentalmvc.Models.Enums
@model Car
@{
    ViewData["Title"] = $"Chi tiết xe - {Model.Name}";

    // Get data from ViewBag
    var reviews = ViewBag.Reviews as List<Review> ?? new List<Review>();
    var averageRating = (double)(ViewBag.AverageRating ?? 0.0);
    var reviewCount = (int)(ViewBag.ReviewCount ?? 0);
    var ratingDistribution = ViewBag.RatingDistribution as Dictionary<int, int> ?? new Dictionary<int, int>();
    var relatedCars = ViewBag.RelatedCars as List<Car> ?? new List<Car>();

    var getCarStatusText = ViewBag.GetCarStatusText as Func<CarStatus, string>;
    var getTransmissionText = ViewBag.GetTransmissionText as Func<Transmission?, string?>;
    var getFuelTypeText = ViewBag.GetFuelTypeText as Func<FuelType?, string?>;

    // Get images
    var imageUrls = Model.CarImages?.OrderByDescending(img => img.IsPrimary)
        .ThenBy(img => img.DisplayOrder)
        .Select(img => img.ImageUrl)
        .ToList() ?? new List<string>();

    // Get features
    var features = Model.CarFeatures?.Select(cf => cf.Feature).ToList() ?? new List<Feature>();

    // Check if car has 3D model
    var has3DModel = Model.CarModel3D != null && !string.IsNullOrEmpty(Model.CarModel3D.ModelUrl);
}

<!-- Modern Car Details Page -->
<div class="car-details-modern">
    <!-- Breadcrumb -->
    <nav aria-label="breadcrumb" class="mb-4">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a asp-action="Index"><i class="fas fa-home me-1"></i>Trang chủ</a></li>
            <li class="breadcrumb-item"><a asp-action="Index">Danh sách xe</a></li>
            <li class="breadcrumb-item"><a asp-action="Index" asp-route-brandId="@Model.BrandId">@(Model.Brand?.Name ?? "N/A")</a></li>
            <li class="breadcrumb-item active">@Model.Name</li>
        </ol>
    </nav>

    <!-- Car Header -->
    <div class="car-header-section">
        <div class="row align-items-center">
            <div class="col-lg-7">
                <div class="badge-group mb-3">
                    <span class="badge badge-primary"><i class="fas fa-certificate me-1"></i>@(Model.Brand?.Name ?? "N/A")</span>
                    <span class="badge badge-secondary">@(Model.Category?.Name ?? "N/A")</span>
                    <span class="badge badge-@(GetCarStatusBadgeClass(Model.Status))">
                        @(getCarStatusText != null ? getCarStatusText(Model.Status) : Model.Status.ToString())
                    </span>
                    @if (Model.Year > 0)
                    {
                        <span class="badge badge-info"><i class="fas fa-calendar me-1"></i>@Model.Year</span>
                    }
                </div>
                <h1 class="car-title-modern">@Model.Name</h1>
                @if (reviewCount > 0)
                {
                    <div class="car-rating-modern">
                        <div class="stars-display">
                            @for (int i = 1; i <= 5; i++)
                            {
                                <i class="fas fa-star @(i <= averageRating ? "star-filled" : "star-empty")"></i>
                            }
                        </div>
                        <span class="rating-score">@averageRating.ToString("F1")</span>
                        <span class="review-count">(@reviewCount đánh giá)</span>
                        <a href="#reviews-section" class="view-reviews-link">Xem đánh giá</a>
                    </div>
                }
            </div>
            <div class="col-lg-5">
                <div class="price-card-modern">
                    <div class="price-main">
                        <div class="price-label">Giá thuê</div>
                        <div class="price-value">@Model.PricePerDay.ToString("N0")<span class="price-unit">VNĐ/ngày</span></div>
                    </div>
                    @if (Model.PricePerHour.HasValue && Model.PricePerHour > 0)
                    {
                        <div class="price-alt">
                            <span class="price-alt-value">@Model.PricePerHour.Value.ToString("N0") VNĐ/giờ</span>
                        </div>
                    }
                    <a asp-area="Customer" asp-controller="Rentals" asp-action="Create" asp-route-CarId="@Model.CarId"
                       class="btn btn-book-now">
                        <i class="fas fa-calendar-check me-2"></i>Đặt thuê ngay
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content Grid -->
    <div class="row mt-4">
        <!-- Left Column: Media & Info -->
        <div class="col-lg-8">
            <!-- Media Tabs (Images & 3D Model) -->
            <div class="media-section">
                <ul class="nav nav-tabs media-tabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" data-bs-toggle="tab" data-bs-target="#images-tab" type="button">
                            <i class="fas fa-images me-2"></i>Hình ảnh
                        </button>
                    </li>
                    @if (has3DModel)
                    {
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" data-bs-toggle="tab" data-bs-target="#model3d-tab" type="button">
                                <i class="fas fa-cube me-2"></i>Xem 3D
                            </button>
                        </li>
                    }
                </ul>

                <div class="tab-content media-content">
                    <!-- Images Tab -->
                    <div class="tab-pane fade show active" id="images-tab" role="tabpanel">
                        @if (imageUrls.Any())
                        {
                            <div id="carImageCarousel" class="carousel slide car-carousel-modern" data-bs-ride="carousel">
                                <div class="carousel-inner">
                                    @for (int i = 0; i < imageUrls.Count; i++)
                                    {
                                        <div class="carousel-item @(i == 0 ? "active" : "")">
                                            <img src="@imageUrls[i]" class="d-block w-100" alt="@Model.Name" loading="lazy">
                                            <div class="image-counter">
                                                <i class="fas fa-camera me-1"></i>@(i + 1) / @imageUrls.Count
                                            </div>
                                        </div>
                                    }
                                </div>
                                @if (imageUrls.Count > 1)
                                {
                                    <button class="carousel-control-prev" type="button" data-bs-target="#carImageCarousel" data-bs-slide="prev">
                                        <span class="carousel-control-prev-icon"></span>
                                    </button>
                                    <button class="carousel-control-next" type="button" data-bs-target="#carImageCarousel" data-bs-slide="next">
                                        <span class="carousel-control-next-icon"></span>
                                    </button>

                                    <!-- Thumbnail indicators -->
                                    <div class="carousel-thumbnails">
                                        @for (int i = 0; i < Math.Min(imageUrls.Count, 6); i++)
                                        {
                                            <button type="button" data-bs-target="#carImageCarousel" data-bs-slide-to="@i"
                                                    class="@(i == 0 ? "active" : "")" style="background-image: url('@imageUrls[i]')">
                                            </button>
                                        }
                                    </div>
                                }
                            </div>
                        }
                        else
                        {
                            <div class="no-images-placeholder">
                                <i class="fas fa-car fa-4x mb-3"></i>
                                <p>Chưa có hình ảnh</p>
                            </div>
                        }
                    </div>

                    <!-- 3D Model Tab -->
                    @if (has3DModel)
                    {
                        <div class="tab-pane fade" id="model3d-tab" role="tabpanel">
                            <div class="model-3d-viewer">
                                <model-viewer
                                    src="@Model.CarModel3D!.ModelUrl"
                                    alt="@Model.Name 3D Model"
                                    camera-controls
                                    auto-rotate
                                    ar
                                    shadow-intensity="1"
                                    exposure="1"
                                    style="width: 100%; height: 500px; background-color: #f0f0f0;">
                                    <div class="model-loading" slot="poster">
                                        <div class="spinner-border text-primary" role="status">
                                            <span class="visually-hidden">Loading...</span>
                                        </div>
                                        <p class="mt-3">Đang tải model 3D...</p>
                                    </div>
                                </model-viewer>
                                <div class="model-controls-hint">
                                    <small>
                                        <i class="fas fa-hand-pointer me-1"></i>Kéo để xoay
                                        <span class="mx-2">|</span>
                                        <i class="fas fa-search-plus me-1"></i>Cuộn để zoom
                                        <span class="mx-2">|</span>
                                        <i class="fas fa-mobile-alt me-1"></i>AR trên điện thoại
                                    </small>
                                </div>
                            </div>
                        </div>
                    }
                </div>
            </div>

            <!-- Car Specifications -->
            <div class="info-section mt-4">
                <h3 class="section-title">
                    <i class="fas fa-cogs text-primary me-2"></i>Thông số kỹ thuật
                </h3>
                <div class="specs-grid-modern">
                    @if (Model.Year > 0)
                    {
                        <div class="spec-card">
                            <div class="spec-icon">
                                <i class="fas fa-calendar-alt"></i>
                            </div>
                            <div class="spec-details">
                                <div class="spec-label">Năm sản xuất</div>
                                <div class="spec-value">@Model.Year</div>
                            </div>
                        </div>
                    }

                    @if (Model.Seats.HasValue && Model.Seats > 0)
                    {
                        <div class="spec-card">
                            <div class="spec-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="spec-details">
                                <div class="spec-label">Số chỗ ngồi</div>
                                <div class="spec-value">@Model.Seats chỗ</div>
                            </div>
                        </div>
                    }

                    @if (Model.Transmission.HasValue)
                    {
                        <div class="spec-card">
                            <div class="spec-icon">
                                <i class="fas fa-cogs"></i>
                            </div>
                            <div class="spec-details">
                                <div class="spec-label">Hộp số</div>
                                <div class="spec-value">@(getTransmissionText != null ? getTransmissionText(Model.Transmission) : Model.Transmission.ToString())</div>
                            </div>
                        </div>
                    }

                    @if (Model.FuelType.HasValue)
                    {
                        <div class="spec-card">
                            <div class="spec-icon">
                                <i class="fas fa-gas-pump"></i>
                            </div>
                            <div class="spec-details">
                                <div class="spec-label">Nhiên liệu</div>
                                <div class="spec-value">@(getFuelTypeText != null ? getFuelTypeText(Model.FuelType) : Model.FuelType.ToString())</div>
                            </div>
                        </div>
                    }

                    @if (!string.IsNullOrEmpty(Model.Color))
                    {
                        <div class="spec-card">
                            <div class="spec-icon">
                                <i class="fas fa-palette"></i>
                            </div>
                            <div class="spec-details">
                                <div class="spec-label">Màu sắc</div>
                                <div class="spec-value">@Model.Color</div>
                            </div>
                        </div>
                    }

                    @if (Model.FuelConsumption.HasValue && Model.FuelConsumption > 0)
                    {
                        <div class="spec-card">
                            <div class="spec-icon">
                                <i class="fas fa-tachometer-alt"></i>
                            </div>
                            <div class="spec-details">
                                <div class="spec-label">Tiêu thụ nhiên liệu</div>
                                <div class="spec-value">@Model.FuelConsumption.Value.ToString("F1") L/100km</div>
                            </div>
                        </div>
                    }

                    @if (!string.IsNullOrEmpty(Model.LicensePlate))
                    {
                        <div class="spec-card">
                            <div class="spec-icon">
                                <i class="fas fa-id-card"></i>
                            </div>
                            <div class="spec-details">
                                <div class="spec-label">Biển số</div>
                                <div class="spec-value">@Model.LicensePlate</div>
                            </div>
                        </div>
                    }

                    @if (!string.IsNullOrEmpty(Model.Location))
                    {
                        <div class="spec-card">
                            <div class="spec-icon">
                                <i class="fas fa-map-marker-alt"></i>
                            </div>
                            <div class="spec-details">
                                <div class="spec-label">Vị trí</div>
                                <div class="spec-value">@Model.Location</div>
                            </div>
                        </div>
                    }
                </div>
            </div>

            <!-- Car Features -->
            @if (features.Any())
            {
                <div class="info-section mt-4">
                    <h3 class="section-title">
                        <i class="fas fa-star text-primary me-2"></i>Tính năng nổi bật
                    </h3>
                    <div class="features-grid-modern">
                        @foreach (var feature in features)
                        {
                            <div class="feature-card">
                                <i class="@(feature.Icon ?? "fas fa-check-circle") feature-icon"></i>
                                <span class="feature-name">@feature.Name</span>
                            </div>
                        }
                    </div>
                </div>
            }

            <!-- Car Description -->
            @if (!string.IsNullOrEmpty(Model.Description))
            {
                <div class="info-section mt-4">
                    <h3 class="section-title">
                        <i class="fas fa-align-left text-primary me-2"></i>Mô tả chi tiết
                    </h3>
                    <div class="description-content">
                        @Model.Description
                    </div>
                </div>
            }

            <!-- Delivery Service & Location Info -->
            <div class="info-section mt-4">
                <h3 class="section-title">
                    <i class="fas fa-map-marker-alt text-primary me-2"></i>Vị trí & Giao xe
                </h3>

                <!-- Car Location -->
                <div class="location-info-card mb-3">
                    <div class="location-header">
                        <h5><i class="fas fa-car text-success me-2"></i>Vị trí xe</h5>
                    </div>
                    <div class="location-body">
                        @if (!string.IsNullOrEmpty(Model.Location))
                        {
                            <div class="location-item">
                                <i class="fas fa-map-marked-alt text-primary me-2"></i>
                                <strong>Địa chỉ:</strong> @Model.Location
                            </div>
                        }
                        @if (Model.Latitude.HasValue && Model.Longitude.HasValue)
                        {
                            <div class="location-item">
                                <i class="fas fa-crosshairs text-info me-2"></i>
                                <strong>Tọa độ:</strong> @Model.Latitude.Value.ToString("F6"), @Model.Longitude.Value.ToString("F6")
                            </div>
                            <div class="mt-2">
                                <a href="https://www.google.com/maps?q=@Model.Latitude,@Model.Longitude"
                                   target="_blank" class="btn btn-sm btn-outline-primary">
                                    <i class="fas fa-external-link-alt me-1"></i>Xem trên Google Maps
                                </a>
                            </div>
                        }
                        else
                        {
                            <div class="alert alert-warning mb-0">
                                <i class="fas fa-info-circle me-2"></i>Thông tin vị trí chưa cập nhật
                            </div>
                        }
                    </div>
                </div>

                <!-- Delivery Service -->
                @{
                    var hasDeliveryService = Model.MaxDeliveryDistance.HasValue && Model.MaxDeliveryDistance > 0;
                }
                <div class="delivery-info-card">
                    <div class="delivery-header">
                        <h5>
                            <i class="fas fa-shipping-fast text-primary me-2"></i>
                            Dịch vụ giao xe
                            @if (hasDeliveryService)
                            {
                                <span class="badge badge-success ms-2">
                                    <i class="fas fa-check-circle"></i> Có giao xe
                                </span>
                            }
                            else
                            {
                                <span class="badge bg-secondary ms-2">
                                    <i class="fas fa-times-circle"></i> Không giao xe
                                </span>
                            }
                        </h5>
                    </div>
                    <div class="delivery-body">
                        @if (hasDeliveryService)
                        {
                            <div class="delivery-details">
                                <div class="delivery-row">
                                    <span class="delivery-label">
                                        <i class="fas fa-ruler-horizontal text-primary me-2"></i>
                                        Phạm vi giao xe tối đa:
                                    </span>
                                    <span class="delivery-value">
                                        <span class="badge badge-primary-custom">@Model.MaxDeliveryDistance km</span>
                                    </span>
                                </div>

                                <div class="delivery-row">
                                    <span class="delivery-label">
                                        <i class="fas fa-dollar-sign text-success me-2"></i>
                                        Phí giao xe:
                                    </span>
                                    <span class="delivery-value">
                                        @if (Model.PricePerKmDelivery.HasValue && Model.PricePerKmDelivery > 0)
                                        {
                                            <span class="badge badge-success-custom">@Model.PricePerKmDelivery.Value.ToString("N0") VNĐ/km</span>
                                        }
                                        else
                                        {
                                            <span class="badge badge-info-custom">
                                                <i class="fas fa-gift me-1"></i>Miễn phí
                                            </span>
                                        }
                                    </span>
                                </div>

                                <!-- Delivery Fee Calculator -->
                                @if (Model.PricePerKmDelivery.HasValue && Model.PricePerKmDelivery > 0)
                                {
                                    <div class="delivery-calculator mt-3">
                                        <h6 class="mb-3">
                                            <i class="fas fa-calculator text-primary me-2"></i>
                                            Ước tính phí giao xe
                                        </h6>
                                        <div class="row g-2">
                                            @{
                                                var distances = new[] { 5, 10, 20, 30, 50 };
                                                foreach (var dist in distances)
                                                {
                                                    var isInRange = dist <= Model.MaxDeliveryDistance.Value;
                                                    var fee = isInRange ? dist * Model.PricePerKmDelivery.Value : 0;

                                                    <div class="col-4 col-md-2">
                                                        <div class="fee-estimate @(isInRange ? "in-range" : "out-of-range")">
                                                            <div class="fee-distance">@dist km</div>
                                                            <div class="fee-amount">
                                                                @if (isInRange)
                                                                {
                                                                    <span class="text-success">@fee.ToString("N0")</span>
                                                                }
                                                                else
                                                                {
                                                                    <small class="text-muted">Ngoài<br/>phạm vi</small>
                                                                }
                                                            </div>
                                                        </div>
                                                    </div>
                                                }
                                            }
                                        </div>
                                    </div>
                                }

                                <!-- Delivery Info Alert -->
                                <div class="alert alert-success mt-3 mb-0">
                                    <div class="d-flex align-items-start">
                                        <i class="fas fa-info-circle me-2 mt-1"></i>
                                        <div>
                                            <strong>Thông tin giao xe:</strong>
                                            <ul class="mb-0 mt-2 ps-3">
                                                <li>Chủ xe có thể giao xe tận nơi trong phạm vi <strong>@Model.MaxDeliveryDistance km</strong></li>
                                                <li>
                                                    Chi phí giao xe:
                                                    @if (Model.PricePerKmDelivery.HasValue && Model.PricePerKmDelivery > 0)
                                                    {
                                                        <strong>@Model.PricePerKmDelivery.Value.ToString("N0") VNĐ/km</strong>
                                                    }
                                                    else
                                                    {
                                                        <strong class="text-success">Miễn phí</strong>
                                                    }
                                                </li>
                                                <li>Phí giao xe được tính dựa trên khoảng cách từ vị trí xe đến địa chỉ của bạn</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        }
                        else
                        {
                            <div class="alert alert-warning mb-0">
                                <div class="d-flex align-items-start">
                                    <i class="fas fa-exclamation-triangle me-2 mt-1"></i>
                                    <div>
                                        <strong>Không cung cấp dịch vụ giao xe</strong>
                                        <p class="mb-0 mt-2">
                                            Bạn cần đến vị trí xe để nhận xe.
                                            @if (!string.IsNullOrEmpty(Model.Location))
                                            {
                                                <span>Địa chỉ: <strong>@Model.Location</strong></span>
                                            }
                                        </p>
                                    </div>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            </div>

            <!-- Owner Information -->
            <div class="info-section mt-4">
                <h3 class="section-title">
                    <i class="fas fa-user-circle text-primary me-2"></i>Thông tin chủ xe
                </h3>
                <div class="owner-card-modern">
                    <div class="owner-avatar-modern">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="owner-info-modern">
                        <h5 class="owner-name">@(Model.Owner?.FullName ?? "N/A")</h5>
                        <div class="owner-contacts">
                            @if (!string.IsNullOrEmpty(Model.Owner?.PhoneNumber))
                            {
                                <a href="tel:@Model.Owner.PhoneNumber" class="owner-contact-link">
                                    <i class="fas fa-phone me-1"></i>@Model.Owner.PhoneNumber
                                </a>
                            }
                            @if (!string.IsNullOrEmpty(Model.Owner?.Email))
                            {
                                <a href="mailto:@Model.Owner.Email" class="owner-contact-link">
                                    <i class="fas fa-envelope me-1"></i>@Model.Owner.Email
                                </a>
                            }
                        </div>
                    </div>
                </div>
            </div>

            <!-- Reviews Section -->
            @if (reviews.Any())
            {
                <div class="info-section mt-4" id="reviews-section">
                    <h3 class="section-title">
                        <i class="fas fa-comments text-primary me-2"></i>Đánh giá từ khách hàng
                    </h3>

                    <!-- Rating Summary -->
                    <div class="rating-summary-card">
                        <div class="row">
                            <div class="col-md-4 text-center">
                                <div class="rating-average-display">
                                    <div class="rating-number-large">@averageRating.ToString("F1")</div>
                                    <div class="rating-stars-large">
                                        @for (int i = 1; i <= 5; i++)
                                        {
                                            <i class="fas fa-star @(i <= averageRating ? "star-filled" : "star-empty")"></i>
                                        }
                                    </div>
                                    <div class="rating-count-text">Dựa trên @reviewCount đánh giá</div>
                                </div>
                            </div>
                            <div class="col-md-8">
                                <div class="rating-distribution">
                                    @for (int star = 5; star >= 1; star--)
                                    {
                                        var count = ratingDistribution.ContainsKey(star) ? ratingDistribution[star] : 0;
                                        var percentage = reviewCount > 0 ? (count * 100.0 / reviewCount) : 0;
                                        <div class="rating-bar-row">
                                            <span class="rating-star-label">@star <i class="fas fa-star star-small"></i></span>
                                            <div class="rating-progress-bar">
                                                <div class="rating-progress-fill" style="width: @percentage.ToString("F0")%"></div>
                                            </div>
                                            <span class="rating-count-number">@count</span>
                                        </div>
                                    }
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Review List -->
                    <div class="reviews-list-modern">
                        @foreach (var review in reviews.Take(5))
                        {
                            <div class="review-card-modern">
                                <div class="review-header-modern">
                                    <div class="reviewer-profile">
                                        <div class="reviewer-avatar-icon">
                                            <i class="fas fa-user-circle"></i>
                                        </div>
                                        <div class="reviewer-details">
                                            <h6 class="reviewer-name-text">@(review.User?.FullName ?? "Người dùng ẩn danh")</h6>
                                            <div class="review-meta-info">
                                                <div class="review-stars-small">
                                                    @for (int i = 1; i <= 5; i++)
                                                    {
                                                        <i class="fas fa-star @(i <= review.Rating ? "star-filled" : "star-empty")"></i>
                                                    }
                                                </div>
                                                <span class="review-date-text">@review.CreatedAt.ToString("dd/MM/yyyy")</span>
                                            </div>
                                        </div>
                                    </div>
                                    @if (review.IsRecommended)
                                    {
                                        <span class="badge badge-recommend">
                                            <i class="fas fa-thumbs-up"></i> Đề xuất
                                        </span>
                                    }
                                </div>
                                @if (!string.IsNullOrEmpty(review.Comment))
                                {
                                    <div class="review-comment-text">
                                        @review.Comment
                                    </div>
                                }
                            </div>
                        }
                    </div>

                    @if (reviewCount > 5)
                    {
                        <div class="text-center mt-3">
                            <button class="btn btn-outline-primary">
                                <i class="fas fa-chevron-down me-2"></i>Xem thêm @(reviewCount - 5) đánh giá
                            </button>
                        </div>
                    }
                </div>
            }

            <!-- Related Cars -->
            @if (relatedCars.Any())
            {
                <div class="info-section mt-4">
                    <h3 class="section-title">
                        <i class="fas fa-car text-primary me-2"></i>Xe tương tự
                    </h3>
                    <div class="row">
                        @foreach (var relatedCar in relatedCars)
                        {
                            var relatedPrimaryImage = relatedCar.CarImages?.FirstOrDefault(img => img.IsPrimary);
                            <div class="col-md-6 col-lg-3 mb-3">
                                <div class="related-car-card-modern">
                                    <a asp-action="Details" asp-route-id="@relatedCar.CarId" class="related-car-link">
                                        <div class="related-car-image-wrapper">
                                            @if (relatedPrimaryImage != null && !string.IsNullOrEmpty(relatedPrimaryImage.ImageUrl))
                                            {
                                                <img src="@relatedPrimaryImage.ImageUrl" alt="@relatedCar.Name" class="related-car-image" loading="lazy">
                                            }
                                            else
                                            {
                                                <div class="related-car-placeholder">
                                                    <i class="fas fa-car"></i>
                                                </div>
                                            }
                                        </div>
                                        <div class="related-car-info-wrapper">
                                            <h6 class="related-car-name">@relatedCar.Name</h6>
                                            <p class="related-car-price-text">@relatedCar.PricePerDay.ToString("N0") VNĐ/ngày</p>
                                        </div>
                                    </a>
                                </div>
                            </div>
                        }
                    </div>
                </div>
            }
        </div>

        <!-- Right Column: Sticky Booking Card -->
        <div class="col-lg-4">
            <div class="booking-sidebar sticky-top">
                <div class="quick-booking-card">
                    <h4 class="booking-card-title">
                        <i class="fas fa-calendar-check me-2"></i>Đặt thuê nhanh
                    </h4>

                    @* ✅ Warning for Rented Cars *@
                    @if (Model.Status == CarStatus.Rented)
                    {
                        <div class="alert alert-warning mb-3">
                            <div class="d-flex align-items-start">
                                <i class="fas fa-info-circle me-2 mt-1"></i>
                                <div>
                                    <strong>Xe đang được thuê</strong>
                                    <p class="mb-0 small mt-1">
                                        Bạn có thể đặt trước cho các ngày sau khi xe trống lịch.
                                    </p>
                                </div>
                            </div>
                        </div>
                    }

                    <div class="price-summary-sidebar">
                        <div class="price-row-sidebar">
                            <span class="price-label-sidebar">Giá thuê theo ngày</span>
                            <span class="price-value-sidebar">@Model.PricePerDay.ToString("N0") VNĐ</span>
                        </div>
                        @if (Model.PricePerHour.HasValue && Model.PricePerHour > 0)
                        {
                            <div class="price-row-sidebar">
                                <span class="price-label-sidebar">Giá thuê theo giờ</span>
                                <span class="price-value-sidebar">@Model.PricePerHour.Value.ToString("N0") VNĐ</span>
                            </div>
                        }
                    </div>

                    @if (Model.Status == CarStatus.Available && Model.IsActive)
                    {
                        <a asp-area="Customer" asp-controller="Rentals" asp-action="Create" asp-route-CarId="@Model.CarId"
                           class="btn btn-book-sidebar">
                            <i class="fas fa-calendar-check me-2"></i>Đặt thuê ngay
                        </a>

                        <div class="booking-benefits">
                            <div class="benefit-item">
                                <i class="fas fa-check-circle text-success me-2"></i>
                                <span>Xác nhận ngay lập tức</span>
                            </div>
                            <div class="benefit-item">
                                <i class="fas fa-shield-alt text-success me-2"></i>
                                <span>Bảo hiểm toàn diện</span>
                            </div>
                            <div class="benefit-item">
                                <i class="fas fa-headset text-success me-2"></i>
                                <span>Hỗ trợ 24/7</span>
                            </div>
                        </div>
                    }
                    else if (Model.Status == CarStatus.Rented && Model.IsActive)
                    {
                        <div class="alert alert-warning mb-3">
                            <div class="d-flex align-items-start">
                                <i class="fas fa-info-circle me-2 mt-1"></i>
                                <div>
                                    <strong>Xe đang được thuê</strong>
                                    <p class="mb-0 small mt-1">
                                        Bạn có thể đặt trước cho các ngày sau khi xe trống lịch.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <a asp-area="Customer" asp-controller="Rentals" asp-action="Create" asp-route-CarId="@Model.CarId"
                           class="btn btn-warning btn-lg w-100 mb-2">
                            <i class="fas fa-calendar-alt me-2"></i>Đặt trước cho ngày sau
                        </a>

                        <div class="booking-benefits">
                            <div class="benefit-item">
                                <i class="fas fa-clock text-warning me-2"></i>
                                <span>Đặt lịch linh hoạt</span>
                            </div>
                            <div class="benefit-item">
                                <i class="fas fa-shield-alt text-success me-2"></i>
                                <span>Bảo hiểm toàn diện</span>
                            </div>
                            <div class="benefit-item">
                                <i class="fas fa-headset text-success me-2"></i>
                                <span>Hỗ trợ 24/7</span>
                            </div>
                        </div>
                    }
                    else
                    {
                        <button type="button" class="btn btn-unavailable" disabled>
                            <i class="fas fa-ban me-2"></i>Xe không khả dụng
                        </button>
                    }
                </div>

                <!-- Safety Guidelines -->
                <div class="safety-card mt-4">
                    <h5 class="safety-title">
                        <i class="fas fa-shield-alt text-success me-2"></i>Cam kết an toàn
                    </h5>
                    <ul class="safety-list-modern">
                        <li>
                            <i class="fas fa-check-circle text-success me-2"></i>
                            Xe được bảo hiểm toàn diện
                        </li>
                        <li>
                            <i class="fas fa-check-circle text-success me-2"></i>
                            Kiểm tra kỹ thuật định kỳ
                        </li>
                        <li>
                            <i class="fas fa-check-circle text-success me-2"></i>
                            Hỗ trợ 24/7 trong suốt chuyến đi
                        </li>
                        <li>
                            <i class="fas fa-check-circle text-success me-2"></i>
                            Hoàn tiền nếu không hài lòng
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script type="module" src="https://cdn.jsdelivr.net/npm/@("@")google/model-viewer@3.3.0/dist/model-viewer.min.js"></script>
}

@section Styles {
    <style>
        /* Modern Car Details Styling */
        .car-details-modern {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* Breadcrumb */
        .breadcrumb {
            background: transparent;
            padding: 0;
            margin-bottom: 20px;
        }

            .breadcrumb-item a {
                color: #007bff;
                text-decoration: none;
            }

                .breadcrumb-item a:hover {
                    text-decoration: underline;
                }

        /* Car Header */
        .car-header-section {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            margin-bottom: 30px;
        }

        .badge-group {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

            .badge-group .badge {
                padding: 8px 14px;
                font-size: 0.9rem;
                font-weight: 500;
                border-radius: 20px;
            }

        .badge-primary {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
        }

        .badge-secondary {
            background: #6c757d;
            color: white;
        }

        .badge-success {
            background: #28a745;
            color: white;
        }

        .badge-info {
            background: #17a2b8;
            color: white;
        }

        .badge-warning {
            background: #ffc107;
            color: #212529;
        }

        .car-title-modern {
            font-size: 2.5rem;
            font-weight: 800;
            color: #2c3e50;
            margin-bottom: 15px;
            line-height: 1.2;
        }

        .car-rating-modern {
            display: flex;
            align-items: center;
            gap: 12px;
            flex-wrap: wrap;
        }

        .stars-display {
            font-size: 1.2rem;
        }

        .star-filled {
            color: #ffc107;
        }

        .star-empty {
            color: #dee2e6;
        }

        .rating-score {
            font-size: 1.1rem;
            font-weight: 700;
            color: #2c3e50;
        }

        .review-count {
            color: #6c757d;
        }

        .view-reviews-link {
            color: #007bff;
            text-decoration: none;
            font-weight: 500;
        }

            .view-reviews-link:hover {
                text-decoration: underline;
            }

        /* Price Card */
        .price-card-modern {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            text-align: center;
        }

        .price-label {
            font-size: 0.9rem;
            color: #6c757d;
            margin-bottom: 5px;
        }

        .price-value {
            font-size: 2.5rem;
            font-weight: 800;
            color: #28a745;
            line-height: 1;
        }

        .price-unit {
            font-size: 1rem;
            color: #6c757d;
            font-weight: 400;
        }

        .price-alt {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #e9ecef;
        }

        .price-alt-value {
            font-size: 1.1rem;
            color: #17a2b8;
            font-weight: 600;
        }

        .btn-book-now {
            width: 100%;
            padding: 15px;
            margin-top: 20px;
            background: linear-gradient(135deg, #007bff, #0056b3);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

            .btn-book-now:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 20px rgba(0,123,255,0.3);
                color: white;
            }

        /* Media Section */
        .media-section {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
        }

        .media-tabs {
            border-bottom: 2px solid #e9ecef;
            padding: 0 20px;
            background: #f8f9fa;
        }

            .media-tabs .nav-link {
                border: none;
                color: #6c757d;
                font-weight: 600;
                padding: 15px 25px;
                transition: all 0.3s ease;
            }

                .media-tabs .nav-link.active {
                    color: #007bff;
                    background: white;
                    border-radius: 10px 10px 0 0;
                }

                .media-tabs .nav-link:hover {
                    color: #007bff;
                }

        .media-content {
            padding: 0;
        }

        /* Carousel */
        .car-carousel-modern {
            position: relative;
        }

            .car-carousel-modern .carousel-inner {
                border-radius: 0;
            }

            .car-carousel-modern img {
                height: 500px;
                object-fit: cover;
                width: 100%;
            }

        .image-counter {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .carousel-thumbnails {
            display: flex;
            justify-content: center;
            gap: 10px;
            padding: 15px;
            background: #f8f9fa;
        }

            .carousel-thumbnails button {
                width: 80px;
                height: 60px;
                border: 3px solid transparent;
                border-radius: 8px;
                background-size: cover;
                background-position: center;
                opacity: 0.6;
                transition: all 0.3s ease;
                cursor: pointer;
            }

                .carousel-thumbnails button.active,
                .carousel-thumbnails button:hover {
                    border-color: #007bff;
                    opacity: 1;
                }

        .no-images-placeholder {
            height: 500px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
            color: #6c757d;
        }

        /* 3D Model Viewer */
        .model-3d-viewer {
            padding: 20px;
            background: #f0f0f0;
        }

        .model-loading {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
        }

        .model-controls-hint {
            text-align: center;
            padding: 15px;
            background: white;
            margin-top: 10px;
            border-radius: 8px;
            color: #6c757d;
        }

        /* Info Sections */
        .info-section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.06);
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }

        /* Specs Grid */
        .specs-grid-modern {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
        }

        .spec-card {
            display: flex;
            align-items: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            transition: all 0.3s ease;
        }

            .spec-card:hover {
                background: #e9ecef;
                transform: translateY(-3px);
            }

        .spec-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #007bff, #0056b3);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.3rem;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .spec-details {
            flex: 1;
        }

        .spec-label {
            font-size: 0.85rem;
            color: #6c757d;
            margin-bottom: 4px;
        }

        .spec-value {
            font-size: 1.1rem;
            font-weight: 700;
            color: #2c3e50;
        }

        /* Features Grid */
        .features-grid-modern {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 12px;
        }

        .feature-card {
            display: flex;
            align-items: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

            .feature-card:hover {
                background: #e9ecef;
            }

        .feature-icon {
            color: #007bff;
            font-size: 1.2rem;
            margin-right: 12px;
        }

        .feature-name {
            font-weight: 500;
            color: #2c3e50;
        }

        /* Description */
        .description-content {
            line-height: 1.8;
            color: #495057;
            font-size: 1rem;
        }

        /* Owner Card */
        .owner-card-modern {
            display: flex;
            align-items: center;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 12px;
        }

        .owner-avatar-modern {
            width: 70px;
            height: 70px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 20px;
            font-size: 3rem;
            color: #007bff;
        }

        .owner-name {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .owner-contacts {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .owner-contact-link {
            color: #007bff;
            text-decoration: none;
            font-weight: 500;
        }

            .owner-contact-link:hover {
                text-decoration: underline;
            }

        /* Reviews */
        .rating-summary-card {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 25px;
        }

        .rating-average-display {
            padding: 20px;
        }

        .rating-number-large {
            font-size: 3.5rem;
            font-weight: 800;
            color: #ffc107;
        }

        .rating-stars-large {
            font-size: 1.5rem;
            margin: 10px 0;
        }

        .rating-count-text {
            color: #6c757d;
            font-size: 0.95rem;
        }

        .rating-distribution {
            padding: 15px 0;
        }

        .rating-bar-row {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 10px;
        }

        .rating-star-label {
            min-width: 60px;
            font-weight: 600;
            color: #2c3e50;
        }

        .star-small {
            color: #ffc107;
            font-size: 0.8rem;
        }

        .rating-progress-bar {
            flex: 1;
            height: 12px;
            background: #dee2e6;
            border-radius: 6px;
            overflow: hidden;
        }

        .rating-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #ffc107, #ff9800);
            transition: width 0.5s ease;
        }

        .rating-count-number {
            min-width: 40px;
            text-align: right;
            color: #6c757d;
            font-weight: 500;
        }

        .reviews-list-modern {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .review-card-modern {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            transition: all 0.3s ease;
        }

            .review-card-modern:hover {
                background: #e9ecef;
            }

        .review-header-modern {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .reviewer-profile {
            display: flex;
            gap: 12px;
        }

        .reviewer-avatar-icon {
            font-size: 2.5rem;
            color: #6c757d;
        }

        .reviewer-name-text {
            margin: 0;
            font-weight: 700;
            color: #2c3e50;
        }

        .review-meta-info {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 5px;
        }

        .review-stars-small {
            font-size: 0.9rem;
        }

        .review-date-text {
            color: #6c757d;
            font-size: 0.85rem;
        }

        .badge-recommend {
            background: #28a745;
            color: white;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.85rem;
        }

        .review-comment-text {
            line-height: 1.6;
            color: #495057;
        }

        /* Related Cars */
        .related-car-card-modern {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 3px 12px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
        }

            .related-car-card-modern:hover {
                transform: translateY(-5px);
                box-shadow: 0 6px 20px rgba(0,0,0,0.15);
            }

        .related-car-link {
            text-decoration: none;
            color: inherit;
        }

        .related-car-image-wrapper {
            height: 160px;
            overflow: hidden;
        }

        .related-car-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .related-car-card-modern:hover .related-car-image {
            transform: scale(1.05);
        }

        .related-car-placeholder {
            height: 100%;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            color: #6c757d;
        }

        .related-car-info-wrapper {
            padding: 15px;
        }

        .related-car-name {
            margin: 0 0 8px 0;
            font-weight: 700;
            color: #2c3e50;
            font-size: 1rem;
        }

        .related-car-price-text {
            margin: 0;
            color: #28a745;
            font-weight: 600;
            font-size: 1.1rem;
        }

        /* Sticky Booking Sidebar */
        .booking-sidebar {
            top: 100px;
        }

        .quick-booking-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }

        .booking-card-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 20px;
        }

        @* ✅ Warning for Rented Cars *@
        @if (Model.Status == CarStatus.Rented)
        {
            <div class="alert alert-warning mb-3">
                <div class="d-flex align-items-start">
                    <i class="fas fa-info-circle me-2 mt-1"></i>
                    <div>
                        <strong>Xe đang được thuê</strong>
                        <p class="mb-0 small mt-1">
                            Bạn có thể đặt trước cho các ngày sau khi xe trống lịch.
                        </p>
                    </div>
                </div>
            </div>
        }

        .price-summary-sidebar {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .price-row-sidebar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

            .price-row-sidebar:last-child {
                margin-bottom: 0;
            }

        .price-label-sidebar {
            color: #6c757d;
            font-size: 0.9rem;
        }

        .price-value-sidebar {
            font-weight: 700;
            color: #28a745;
            font-size: 1.1rem;
        }

        .btn-book-sidebar {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #007bff, #0056b3);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 1.1rem;
            font-weight: 600;
            text-decoration: none;
            display: block;
            text-align: center;
            transition: all 0.3s ease;
        }

            .btn-book-sidebar:hover {
                transform: translateY(-2px);
                box-shadow: 0 8px 20px rgba(0,123,255,0.3);
                color: white;
            }

        .btn-unavailable {
            width: 100%;
            padding: 15px;
            background: #6c757d;
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .booking-benefits {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #e9ecef;
        }

        .benefit-item {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            font-size: 0.95rem;
            color: #495057;
        }

            .benefit-item:last-child {
                margin-bottom: 0;
            }

        /* Safety Card */
        .safety-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.08);
        }

        .safety-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .safety-list-modern {
            list-style: none;
            padding: 0;
            margin: 0;
        }

            .safety-list-modern li {
                padding: 10px 0;
                border-bottom: 1px solid #f8f9fa;
                font-size: 0.95rem;
                color: #495057;
            }

                .safety-list-modern li:last-child {
                    border-bottom: none;
                }

        /* Responsive */
        @@media (max-width: 992px) {
            .car-title-modern {
                font-size: 2rem;
            }

            .price-value {
                font-size: 2rem;
            }

            .car-carousel-modern img {
                height: 350px;
            }

            .booking-sidebar {
                position: static !important;
                top: auto;
            }

            .specs-grid-modern {
                grid-template-columns: 1fr;
            }

            .features-grid-modern {
                grid-template-columns: 1fr;
            }
        }

        @@media (max-width: 576px) {
            .car-details-modern {
                padding: 15px 10px;
            }

            .car-header-section {
                padding: 20px 15px;
            }

            .car-title-modern {
                font-size: 1.5rem;
            }

            .info-section {
                padding: 20px 15px;
            }

            .section-title {
                font-size: 1.2rem;
            }

            .car-carousel-modern img {
                height: 250px;
            }

            .carousel-thumbnails button {
                width: 60px;
                height: 45px;
            }
        }

        /* Location & Delivery Info Cards */
        .location-info-card,
        .delivery-info-card {
            background: white;
            border-radius: 12px;
            border: 2px solid #e9ecef;
            overflow: hidden;
        }

        .location-header,
        .delivery-header {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 15px 20px;
            border-bottom: 1px solid #e9ecef;
        }

            .location-header h5,
            .delivery-header h5 {
                margin: 0;
                font-size: 1.1rem;
                font-weight: 700;
                color: #2c3e50;
                display: flex;
                align-items: center;
                flex-wrap: wrap;
                gap: 10px;
            }

        .location-body,
        .delivery-body {
            padding: 20px;
        }

        .location-item {
            padding: 12px 0;
            border-bottom: 1px solid #f8f9fa;
            color: #495057;
        }

            .location-item:last-child {
                border-bottom: none;
            }

        /* Delivery Details */
        .delivery-details {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
        }

        .delivery-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #e9ecef;
        }

            .delivery-row:last-child {
                border-bottom: none;
            }

        .delivery-label {
            font-weight: 500;
            color: #495057;
        }

        .delivery-value {
            text-align: right;
        }

        /* Custom Badges for Delivery */
        .badge-primary-custom {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.95rem;
            font-weight: 600;
        }

        .badge-success-custom {
            background: linear-gradient(135deg, #28a745, #1e7e34);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.95rem;
            font-weight: 600;
        }

        .badge-info-custom {
            background: linear-gradient(135deg, #17a2b8, #117a8b);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.95rem;
            font-weight: 600;
        }

        /* Delivery Fee Calculator */
        .delivery-calculator {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #e9ecef;
        }

            .delivery-calculator h6 {
                color: #2c3e50;
                font-weight: 700;
            }

        .fee-estimate {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            padding: 15px 10px;
            text-align: center;
            transition: all 0.3s ease;
        }

            .fee-estimate.in-range {
                border-color: #28a745;
                background: linear-gradient(135deg, #f0fff4, #e6f7ee);
            }

                .fee-estimate.in-range:hover {
                    transform: translateY(-3px);
                    box-shadow: 0 4px 12px rgba(40, 167, 69, 0.2);
                }

            .fee-estimate.out-of-range {
                background: #f8f9fa;
                opacity: 0.7;
            }

        .fee-distance {
            font-size: 0.85rem;
            color: #6c757d;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .fee-amount {
            font-size: 1.1rem;
            font-weight: 700;
        }
    </style>
}

@functions {
    private string GetCarStatusBadgeClass(CarStatus status)
    {
        return status switch
        {
            CarStatus.Available => "success",
            CarStatus.Rented => "warning",
            CarStatus.Maintenance => "danger",
            CarStatus.PendingApproval => "secondary",
            CarStatus.Reserved => "info",
            _ => "secondary"
        };
    }
}